<div class="product-details-page">
  <div class="container">
    <div class="breadcrumb-nav">
      <a routerLink="/home">Home</a>
      <span> > </span>
      <a routerLink="/products">Shop</a>
      <span> > </span>
      <a
        routerLink="/products"
        [queryParams]="{ category: product?.category }"
        >{{ product?.category }}</a
      >
      <span> > </span>
      <span class="current">{{ product?.name }}</span>
    </div>

    <div class="product-wrapper neumorph-card">
      <div class="product-gallery">
        <div class="main-image-container">
          <img
            [src]="selectedImage || '/api/placeholder/600/450'"
            [alt]="product?.name"
            class="main-image"
          />
          <div class="image-badges" *ngIf="product?.badge">
            <span class="badge" [ngClass]="product?.badgeType">{{
              product?.badge
            }}</span>
          </div>
        </div>

        <div class="thumbnail-gallery">
          <div
            class="thumbnail"
            *ngFor="let image of product?.images; let i = index"
            [class.active]="selectedImage === image"
            (click)="selectImage(image)"
          >
            <img
              [src]="image || '/api/placeholder/100/100'"
              [alt]="product?.name + ' view ' + (i + 1)"
            />
          </div>
        </div>
      </div>

      <div class="product-info">
        <h1 class="product-title">{{ product?.name }}</h1>

        <div class="product-meta">
          <div class="product-rating">
            <div class="stars">
              <ng-container *ngFor="let i of [1, 2, 3, 4, 5]">
                <mat-icon *ngIf="product && i <= product.rating">star</mat-icon>
                <mat-icon *ngIf="product && i > product.rating && i - 1 < product.rating">star_half</mat-icon>
                <mat-icon *ngIf="product && i > product.rating && i - 1 >= product.rating">star_border</mat-icon>
              </ng-container>
            </div>
            <a href="#reviews" class="review-count"
              >{{ product?.reviewCount }} Reviews</a
            >
          </div>

          <div
            class="product-availability"
            [ngClass]="{
              'in-stock': product?.inStock,
              'out-of-stock': !product?.inStock
            }"
          >
            <mat-icon *ngIf="product?.inStock">check_circle</mat-icon>
            <mat-icon *ngIf="!product?.inStock">cancel</mat-icon>
            <span>{{ product?.inStock ? "In Stock" : "Out of Stock" }}</span>
          </div>
        </div>

        <div class="product-price">
          <span class="current-price">${{ product?.price?.toFixed(2) }}</span>
          <span class="old-price" *ngIf="product?.oldPrice"
            >${{ product?.oldPrice?.toFixed(2) }}</span
          >
          <span class="discount-tag" *ngIf="product?.discount"
            >{{ product?.discount }}% OFF</span
          >
        </div>

        <div class="product-description">
          <p>{{ product?.shortDescription }}</p>
        </div>

        <div class="product-options">
          <!-- Use a safe check that Angular's type checker can understand -->
          <div
            class="option-group"
            *ngIf="product && product.colors && product.colors.length > 0"
          >
            <h3 class="option-title">Color</h3>
            <div class="color-options">
              <div
                *ngFor="let color of product.colors"
                class="color-option"
                [style.background-color]="color.code"
                [class.selected]="selectedColor === color.name"
                [attr.title]="color.name"
                (click)="selectColor(color.name)"
              >
                <mat-icon *ngIf="selectedColor === color.name" style="width: auto; height:auto">check</mat-icon>
              </div>
            </div>
          </div>

          <div class="option-group">
            <h3 class="option-title">Quantity</h3>
            <div class="quantity-selector">
              <button
                (click)="decreaseQuantity()"
                [disabled]="quantity <= 1"
              >
                <mat-icon>remove</mat-icon>
              </button>
              <input type="number" [(ngModel)]="quantity" min="1" max="10" />
              <button
                (click)="increaseQuantity()"
                [disabled]="quantity >= 10"
              >
                <mat-icon>add</mat-icon>
              </button>
            </div>
          </div>
        </div>

        <div class="product-actions">
          <button
            class="neumorph-button add-to-cart-btn"
            [disabled]="!product?.inStock"
            (click)="addToCart()"
          >
            <mat-icon>shopping_cart</mat-icon> Add to Cart
          </button>
          <button
            class="neumorph-button wishlist-btn"
            (click)="addToWishlist()"
          >
            <mat-icon>favorite</mat-icon> Add to Wishlist
          </button>
        </div>

        <!-- Fixed features section - using product features from the interface -->
        <div class="product-features">
          <div class="feature">
            <mat-icon>local_shipping</mat-icon>
            <div class="feature-text">
              <h4>Free Shipping</h4>
              <p>On orders over $999</p>
            </div>
            </div>
            <div class="feature">
              <mat-icon>schedule</mat-icon>
              <div class="feature-text">
           <h4>Easy Returns</h4>
           <p>30-day return policy</p>
          </div>
          </div>
          <div class="feature">
        <mat-icon>verified</mat-icon>
        <div class="feature-text">
        <h4>Warranty</h4>
        <p>3-year warranty</p>
            </div>
          </div>
        </div>

        <div class="social-share">
          <span>Share:</span>
          <div class="share-buttons">
            <a href="#" class="share-button" title="Share on Facebook">
              <mat-icon>facebook</mat-icon>
            </a>
            <a href="#" class="share-button" title="Share on Twitter">
              <mat-icon>flutter_dash</mat-icon>
            </a>
            <a href="#" class="share-button" title="Share on Pinterest">
              <mat-icon>pin_drop</mat-icon>
            </a>
            <a href="#" class="share-button" title="Share by Email">
            <mat-icon>email</mat-icon>
           </a>
            </div>
          </div>
       </div>
    </div>

    <div class="product-details-tabs">
      <div class="tabs-header">
        <button class="tab-button active">Description</button>
        <button class="tab-button">Specifications</button>
        <button class="tab-button" id="reviews">Reviews</button>
      </div>
      
      <div class="tab-content">
        <!-- Fixed description section - using description instead of fullDescription -->
        <div class="product-full-description" [innerHTML]="product?.description"></div>
      </div>
    </div>

    <!-- Fixed specifications section - using the correct property names -->
    <div *ngIf="product && product.specifications && product.specifications.length > 0">
      <div *ngFor="let group of product.specifications">
        <div class="spec-group">
          <h3 class="spec-group-title">{{ group.title }}</h3>
          <div class="spec-list">
            <div class="spec-item" *ngFor="let spec of group.items">
              <div class="spec-name">{{ spec.name }}</div>
              <div class="spec-value">{{ spec.value }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Customer reviews section -->
    <div *ngIf="product && product.reviews && product.reviews.length > 0">
      <div class="reviews-summary">
        <div class="average-rating">
          <div class="rating-value">{{ product.rating.toFixed(1) }}</div>
          <div class="rating-stars">
            <ng-container *ngFor="let i of [1, 2, 3, 4, 5]">
              <mat-icon *ngIf="i <= product.rating">star</mat-icon>
              <mat-icon *ngIf="i > product.rating && i - 1 < product.rating">star_half</mat-icon>
              <mat-icon *ngIf="i > product.rating && i - 1 >= product.rating">star_border</mat-icon>
            </ng-container>
          </div>
          <div class="rating-count">Based on {{ product.reviewCount }} reviews</div>
        </div>
      </div>

      <div class="customer-reviews">
        <h3>Customer Reviews</h3>
        <div *ngFor="let review of product.reviews" class="review-item neumorph-card">
          <div class="review-header">
            <div class="reviewer-info">
              <!-- Fixed: using 'name' instead of 'customerName' -->
              <h4 class="reviewer-name">{{ review.name }}</h4>
              <span class="review-date">{{ review.date }}</span>
            </div>
            <div class="review-rating">
              <ng-container *ngFor="let i of [1, 2, 3, 4, 5]">
                <mat-icon *ngIf="i <= review.rating">star</mat-icon>
                <mat-icon *ngIf="i > review.rating && i - 1 < review.rating">star_half</mat-icon>
                <mat-icon *ngIf="i > review.rating && i - 1 >= review.rating">star_border</mat-icon>
              </ng-container>
            </div>
          </div>
          <h3 class="review-title">{{ review.title }}</h3>
          <p class="review-content">{{ review.content }}</p>
          <div class="review-footer">
            <button>
              <mat-icon>thumb_up</mat-icon> Helpful ({{ review.helpfulCount }})
            </button>
            <button class="report-btn">
              <mat-icon>flag</mat-icon> Report
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="related-products">
      <h2 class="section-title">You May Also Like</h2>
      <div class="products-grid">
        <!-- Product cards for related products -->
        <div
          *ngFor="let relatedProduct of relatedProducts"
          class="product-card-wrapper"
        >
          <!-- Product card component would be here -->
        </div>
      </div>
    </div>
  </div>
</div>
