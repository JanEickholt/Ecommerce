<div class="products-page">
  <div class="container">
    <!-- Category Breadcrumb -->
    <app-category-breadcrumb 
      [category]="selectedCategory" 
      [subcategory]="selectedSubcategory">
    </app-category-breadcrumb>

    <!-- Main Content Area with Sidebar -->
    <mat-drawer-container class="products-container">
      <!-- Filter Sidebar -->
      <mat-drawer #filterDrawer mode="side" [opened]="!isMobile" class="filter-sidebar">
        <app-filter-sidebar
          [categories]="categories"
          [priceRange]="priceRange"
          [colors]="colors"
          [materials]="materials"
          [ratings]="ratings"
          [features]="features"
          [filterState]="filterState"
          (filterChanged)="applyFilters($event)"
          (clearFilters)="clearFilters()"
          [isMobile]="isMobile"
          (close)="filterDrawer.close()">
        </app-filter-sidebar>
      </mat-drawer>

      <!-- Main Products Area -->
      <mat-drawer-content class="main-content">
        <!-- Page Header: Title and Filter Toggle -->
        <div class="page-header">
          <h1 class="page-title">
            {{ selectedCategory ? (selectedCategory | titlecase) : 'All Products' }}
            <span *ngIf="selectedSubcategory"> - {{ selectedSubcategory | titlecase }}</span>
          </h1>
          
          <button *ngIf="isMobile" mat-stroked-button class="filter-toggle" (click)="toggleFilterDrawer()">
            <mat-icon>filter_list</mat-icon> Filters
          </button>
        </div>

        <!-- Active Filters Section -->
        <app-active-filters 
          *ngIf="filterState.categories.length > 0 || 
                filterState.colors.length > 0 || 
                filterState.materials.length > 0 || 
                filterState.features.length > 0 || 
                filterState.rating > 0 ||
                (filterState.priceRange.min > 0 || filterState.priceRange.max < 5000)"
          [filterState]="filterState"
          [categories]="categories"
          [colors]="colors" 
          [materials]="materials"
          [features]="features"
          (removeFilter)="removeFilter($event.type, $event.value)"
          (clearAllFilters)="clearFilters()">
        </app-active-filters>

        <!-- Product Grid -->
        <app-product-grid
          [products]="products"
          [totalProducts]="totalProducts"
          [isLoading]="isLoading"
          [viewMode]="viewMode"
          [pageSize]="pageSize"
          (viewModeChanged)="setViewMode($event)"
          (pageChanged)="onPageChange($event)"
          (productAdded)="addToCart($event)"
          (productWishlisted)="addToWishlist($event)"
          (productQuickViewed)="quickView($event)"
          (productCompared)="addToCompare($event)"
          (clearAllFilters)="clearFilters()">
        </app-product-grid>
      </mat-drawer-content>
    </mat-drawer-container>
  </div>
</div>
